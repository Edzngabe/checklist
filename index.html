<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checklist</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    .name-item {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h1>Checklist</h1>
  <div id="checklist"></div>

  <script>
    const names = [
      "Amy", "Evangelos", "Elouise", "Jacob", "Jasmine", "Connor",
      "Matthias & Wilson", "Kat", "Jessica", "Mark", "Barbie", "Elizabeth & Sim",
      "Patrick", "Daniel", "Dominic", "Ricardo", "Tammie & George", "Mum",
      "Chie", "Stella", "Mamu & Adam", "Rodrigo & Enzo", "Cariza", "Jomel",
      "Mean", "Megan", "Bev", "Cha", "Kz", "Renz", "Charles", "Val"
    ];

    const container = document.getElementById('checklist');

    names.forEach(name => {
      const div = document.createElement('div');
      div.className = 'name-item';

      const label = document.createElement('label');
      label.textContent = name;

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.addEventListener('change', () => {
        const checked = checkbox.checked ? "yes" : "no";
        fetch("https://script.google.com/macros/s/AKfycbzYKQdD3eiVSESn1vfzqmv2_pMV8wW2Y5BTld435ZG3ss-pkx5fI5Ny932tS3lc0cc/exec", {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            name: name,
            attending: checked
          })
        }).catch(err => {
          console.error("Error sending data:", err);
          alert("Failed to update checklist. Please try again.");
        });
      });

      div.appendChild(checkbox);
      div.appendChild(label);
      container.appendChild(div);
    });
  </script>
</body>
</html>
